# Теоретический материал: Установка и настройка Strapi

## Способы установки Strapi

### 1. Установка через npx (Рекомендуемый способ)

`npx` - это инструмент, который позволяет выполнять npm пакеты без их глобальной установки. Это самый простой и надежный способ установки Strapi.

**Преимущества:**
- Автоматически получает последнюю версию
- Не требует глобальной установки
- Работает на всех платформах
- Простой процесс установки

**Команда:**
```bash
npx create-strapi-app@latest my-project
```

### 2. Глобальная установка Strapi CLI

Можно установить Strapi CLI глобально для более удобной работы:

```bash
npm install -g @strapi/cli
strapi new my-project
```

**Преимущества:**
- Быстрый доступ к командам Strapi
- Возможность использования в скриптах
- Удобство для опытных разработчиков

**Недостатки:**
- Требует глобальной установки
- Может конфликтовать с другими версиями
- Не всегда получает последние обновления

### 3. Установка из исходного кода

Для разработчиков, которые хотят внести изменения в Strapi:

```bash
git clone https://github.com/strapi/strapi.git
cd strapi
npm install
npm run build
```

## Структура проекта Strapi

После установки Strapi создается следующая структура папок:

```
my-project/
├── .cache/                 # Кэш Strapi
├── .tmp/                   # Временные файлы
├── build/                  # Собранные файлы (production)
├── config/                 # Конфигурационные файлы
│   ├── admin.js           # Настройки админ-панели
│   ├── api.js             # Настройки API
│   ├── database.js        # Настройки базы данных
│   ├── middlewares.js     # Настройки middleware
│   ├── plugins.js         # Настройки плагинов
│   └── server.js          # Настройки сервера
├── database/              # Файлы базы данных (SQLite)
├── dist/                  # Собранные файлы
├── exports/               # Экспортированные данные
├── extensions/            # Расширения Strapi
├── favicon.ico           # Иконка сайта
├── node_modules/         # Зависимости npm
├── public/               # Статические файлы
├── src/                  # Исходный код
│   ├── admin/            # Код админ-панели
│   ├── api/              # API и типы контента
│   ├── extensions/       # Расширения
│   └── index.js          # Точка входа
├── .env                  # Переменные окружения
├── .gitignore           # Исключения Git
├── package.json         # Зависимости и скрипты
├── README.md            # Документация проекта
└── tsconfig.json        # Настройки TypeScript
```

### Ключевые папки и файлы

#### `config/` - Конфигурационные файлы
- **admin.js** - настройки админ-панели (порт, аутентификация)
- **api.js** - настройки API (CORS, rate limiting)
- **database.js** - настройки базы данных
- **server.js** - настройки сервера (порт, хост)

#### `src/` - Исходный код
- **src/api/** - API и типы контента
- **src/admin/** - кастомизация админ-панели
- **src/extensions/** - расширения функциональности

#### `public/` - Статические файлы
- Изображения, CSS, JavaScript файлы
- Файлы, доступные напрямую через веб-сервер

## Режимы работы Strapi

### Development Mode (Режим разработки)

**Характеристики:**
- Автоматическая перезагрузка при изменении файлов
- Подробные сообщения об ошибках
- Неоптимизированный код
- Отладочная информация

**Запуск:**
```bash
npm run develop
# или
yarn develop
```

**Особенности:**
- Сервер запускается на порту 1337
- Админ-панель доступна по адресу http://localhost:1337/admin
- API доступен по адресу http://localhost:1337/api

### Production Mode (Режим продакшена)

**Характеристики:**
- Оптимизированный код
- Минимизированные ресурсы
- Отключенные инструменты разработки
- Высокая производительность

**Запуск:**
```bash
npm run start
# или
yarn start
```

**Особенности:**
- Требует предварительной сборки
- Настроен для высокой нагрузки
- Безопасные настройки по умолчанию

## Конфигурационные файлы

### config/database.js

Настройки базы данных для разных окружений:

```javascript
module.exports = ({ env }) => ({
  connection: {
    client: 'sqlite',
    connection: {
      filename: env('DATABASE_FILENAME', '.tmp/data.db'),
    },
    useNullAsDefault: true,
  },
});
```

### config/server.js

Настройки сервера:

```javascript
module.exports = ({ env }) => ({
  host: env('HOST', '0.0.0.0'),
  port: env.int('PORT', 1337),
  app: {
    keys: env.array('APP_KEYS'),
  },
});
```

### config/admin.js

Настройки админ-панели:

```javascript
module.exports = ({ env }) => ({
  auth: {
    secret: env('ADMIN_JWT_SECRET'),
  },
  apiToken: {
    salt: env('API_TOKEN_SALT'),
  },
});
```

## Переменные окружения (.env)

Файл `.env` содержит конфигурационные параметры:

```env
# База данных
DATABASE_FILENAME=.tmp/data.db

# Сервер
HOST=0.0.0.0
PORT=1337

# Безопасность
APP_KEYS=your-app-keys
API_TOKEN_SALT=your-api-token-salt
ADMIN_JWT_SECRET=your-admin-jwt-secret
JWT_SECRET=your-jwt-secret

# Плагины
TRANSFER_TOKEN_SALT=your-transfer-token-salt
```

## Типы установки

### Quick Start (Быстрый старт)

Самый простой способ для начинающих:

```bash
npx create-strapi-app@latest my-project --quickstart
```

**Особенности:**
- Автоматическая установка SQLite
- Запуск браузера после установки
- Предустановленные настройки
- Идеально для изучения

### Custom Installation (Кастомная установка)

Для более продвинутых пользователей:

```bash
npx create-strapi-app@latest my-project
```

**Возможности:**
- Выбор базы данных
- Настройка аутентификации
- Конфигурация плагинов
- Выбор шаблона

## Поддерживаемые базы данных

### SQLite (По умолчанию)
- **Преимущества**: Простота, не требует установки
- **Недостатки**: Ограниченная производительность
- **Применение**: Разработка, небольшие проекты

### PostgreSQL
- **Преимущества**: Высокая производительность, надежность
- **Недостатки**: Требует установки
- **Применение**: Продакшен, большие проекты

### MySQL
- **Преимущества**: Популярность, хорошая документация
- **Недостатки**: Ограничения по сравнению с PostgreSQL
- **Применение**: Веб-приложения, WordPress интеграция

### MongoDB
- **Преимущества**: Гибкость схемы, масштабируемость
- **Недостатки**: Сложность для реляционных данных
- **Применение**: Проекты с неструктурированными данными

## Системные требования

### Минимальные требования
- **Node.js**: 18.0.0 или выше
- **npm**: 6.0.0 или выше
- **RAM**: 2GB
- **Диск**: 1GB свободного места

### Рекомендуемые требования
- **Node.js**: 20.x LTS
- **npm**: 8.x или выше
- **RAM**: 4GB или больше
- **Диск**: 5GB свободного места
- **Процессор**: Современный многоядерный процессор

## Безопасность

### Основные принципы безопасности Strapi

1. **JWT токены** - для аутентификации пользователей
2. **API токены** - для доступа к API
3. **CORS настройки** - для контроля доступа
4. **Rate limiting** - для защиты от атак
5. **Валидация данных** - для предотвращения инъекций

### Рекомендации по безопасности

- Всегда используйте HTTPS в продакшене
- Регулярно обновляйте зависимости
- Используйте сильные пароли
- Настройте брандмауэр
- Ведите логирование

## Производительность

### Оптимизация для разработки
- Используйте SQLite для быстрой разработки
- Включите кэширование
- Оптимизируйте запросы к базе данных
- Используйте CDN для статических файлов

### Оптимизация для продакшена
- Используйте PostgreSQL или MySQL
- Настройте кэширование Redis
- Оптимизируйте изображения
- Используйте балансировку нагрузки

## Миграция между версиями

### Обновление Strapi
```bash
npm run strapi version
npm run strapi upgrade
```

### Резервное копирование
- Экспорт данных через админ-панель
- Резервное копирование базы данных
- Сохранение конфигурационных файлов

## Лучшие практики

### Организация проекта
- Используйте Git для контроля версий
- Документируйте изменения
- Следуйте соглашениям по именованию
- Разделяйте конфигурацию по окружениям

### Разработка
- Используйте TypeScript для типизации
- Пишите тесты для критического функционала
- Следуйте принципам DRY и SOLID
- Регулярно обновляйте зависимости

### Развертывание
- Используйте CI/CD пайплайны
- Настройте мониторинг
- Планируйте резервное копирование
- Документируйте процедуры развертывания 